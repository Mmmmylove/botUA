const TelegramBot = require('node-telegram-bot-api');

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç BotFather
const token = '6068082376:AAGYwE93yUo7gLaGJeolrTlTB_5WD9cgdPw';

// –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
const bot = new TelegramBot(token, { polling: true });

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º id —á–∞—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è
const chatId = 5264995626;

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
bot.on('message', (msg) => {
  console.log(msg);

  // –ü–µ—Ä–µ—Å—ã–ª–∞–µ–º –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã
  bot.forwardMessage(chatId, msg.chat.id, msg.message_id);

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π /start
  if (msg.text === '/start') {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    bot.sendMessage(chatId, 'üëã –í–∏ –ø—ñ–¥–ø–∏—Å–∞–ª–∏—Å—è –Ω–∞ –±–æ—Ç–∞! –ù–∞–¥—ñ—à–ª—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, —á–∞—Å –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó ‚åö, —Å–∞–º—É –ø—É–±–ª—ñ–∫–∞—Ü—ñ—éüí¨, –Ω–∞–∑–≤—É —Ä–µ—Å—É—Ä—Å—Éüì¢ –Ω–∞ —è–∫–æ–º—É –±—É–¥–µ—Ç–µ –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏, —Ç–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É —Å–∫—Ä–∏–Ω—å–∫—Éüì® —è–∫—É –≤–∏ –≤–∫–∞–∑–∞–ª–∏ –ø—ñ–¥ —á–∞—Å –∫—É–ø—ñ–≤–ª—ñ.\n\n–¢–∞–∫–æ–∂ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:\n/start - –ø–æ—á–∞—Ç–æ–∫ –¥—ñ–∞–ª–æ–≥—É –∑ –±–æ—Ç–æ–º;\n/stop - –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –¥—ñ–∞–ª–æ–≥—É –∑ –±–æ—Ç–æ–º.');

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    bot.once('message', (msg) => {
      // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const [time, publication, resource, email] = msg.text.split(',');

      // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const message = `${time.trim()}, ${publication.trim()}, ${resource.trim()}, ${email.trim()}`;

      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      bot.sendMessage(chatId, message);

      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏
      bot.sendMessage(chatId, '–î—è–∫—É—î–º–æ –∑–∞ –≤–∞—à –≤–∏–±—ñ—Ä. –ú–∏ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ–Ω—É—î–º–æ –ø–æ—Å–ª—É–≥—É –ø—Ä–æ—Ç—è–≥–æ–º —Ä–æ–±–æ—á–æ–≥–æ –¥–Ω—è. –Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è, –±—É–¥—å –ª–∞—Å–∫–∞, –∑–∞ —Ü–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º @nbtwv.');
    });
  } else if (msg.text === '/stop') {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –¥–∏–∞–ª–æ–≥–∞
    bot.sendMessage(chatId, '–î—è–∫—É—î–º–æ –∑–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–∞—à–æ–≥–æ –±–æ—Ç–∞! –Ø–∫—â–æ –≤–∏–Ω–∏–∫–Ω—É—Ç—å –ø–∏—Ç–∞–Ω–Ω—è, –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –±—É–¥—å –ª–∞—Å–∫–∞, –∑–∞ —Ü–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º @nbtwv.');
  }
});